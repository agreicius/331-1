<?xml version="1.0" encoding="UTF-8"?>

<section xml:id="s_gaussian_integers" xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>Gaussian integers</title>
    <introduction><p>
        This section will function basically as a long-format example of analyzing the ideal structure of <m>\Z[i]</m>, the so-called Gaussian integers. Many of the techniques we use can be applied more generally to the family of quadratic rings of integers <m>\mathcal{O}_{\sqrt{D}}</m>. Accordingly, we will begin on the this slightly higher level of generality and indicate some of these techniques. 
    </p></introduction> 
<subsection xml:id="ss_quadratic_ring_integers">
<title>Quadratic ring of integers</title>
<definition xml:id="d_quad_ring_integers">
<title>Quadratic ring of integers</title>
<statement>
<p>
Let <m>D</m> be a square-free integer, and let <m>\sqrt{D}</m> be a choice of square root of <m>D</m> lying in <m>\C</m>. The field <m>F=\Q[\sqrt{D}]</m> is called a <term>quadratic extension</term> of <m>\Q</m>, and we define the subring <m>\mathcal{O}_{\sqrt{D}}\subseteq F</m> as <m>\Z[\omega]=\{m+n\omega\mid m,n\in \Z\}</m>, where 
<md>
    <mrow>\omega \amp =\begin{cases}
    \sqrt{D} \amp \text{if } D\not\equiv 1 \pmod 4\\
    \frac{1}{2}+\frac{\sqrt{D}}{2} \amp \text{if } D\equiv 1\pmod 4
    \end{cases}</mrow>
</md>.
Additionally, the map <m>\alpha=q_1+q_2\sqrt{D}\mapsto \overline{\alpha}=q_1-q_2\sqrt{D}</m> defines a ring automorphism both of <m>\Q[\sqrt{D}]</m> and <m>\mathcal{O}_{\sqrt{D}}=\Z[\omega]</m>, which in turn gives rise to a <term>norm functions</term> <m>N_{\sqrt{D}}\colon \Q[\sqrt{D}]\rightarrow \Q</m> defined as 
<md>
    <mrow>N(\alpha) \amp =\alpha\overline{\alpha}=q_1^2-q_2^2D</mrow>
</md>,
for <m>\alpha=q_1+q_2\sqrt{D}\in \Q[\sqrt{D}]</m>.
</p>
</statement>
</definition>
<remark>
    <title>Quadratic ring of integers</title>
    <p>
        The definition of <m>\omega</m> in <xref ref="d_quad_ring_integers"/> is not as ad hoc as first appears. The ring <m>\mathcal{O}=\mathcal{O}_{\sqrt{D}}</m> is better described as the set of all elements of <m>\Q[\sqrt{D}]</m> that satisfy a monic integer polynomial. This, in general, is what we call the <term>ring of integers</term> of a field <m>F</m> containing <m>\Q</m> as a subfield. This is a fairly abstract definition, and it is not obvious that such a set actually comprises a subring of the given field. In the simple case of a quadratic extension <m>\Q[\sqrt{D}]</m>, we can compute this set by hand to obtain the explicit description <m>\Z[\omega]</m> given in the definition. In particular, though not completely obvious, the set <m>\Z[\omega]</m> is indeed a subring in the case where <m>D\equiv 1\pmod 4</m> and <m>\omega=\tfrac{1}{2}+\tfrac{\sqrt{D}}{2}</m>.
    </p>
</remark>
<proposition xml:id="prop_quad_ring_integers">
    <title>Norm and quadratic rings of integers</title>
    
    
    <statement>
        <p>
            Let <m>D</m> be a square-free integer, let <m>\mathcal{O}=\mathcal{O}_{\sqrt{D}}</m> be the corresponding quadratic ring of integers, and let <m>N=N_{\sqrt{D}}</m> be the corresponding norm function. 
            <ol>
                <li>
                    <p>
                        The norm function <m>N</m> is multiplicative: <ie/>, <m>N(\alpha\beta)=N(\alpha)N(\beta)</m> for all <m>\alpha,\beta \in \Q[\sqrt{D}]</m>.
                    </p>
                </li>
                <li>
                    <p>
                        Assume <m>D\equiv 1\pmod 4</m>, so that <m>\omega=\tfrac{1}{2}+\tfrac{\sqrt{D}}{2}</m>. For all <m>\alpha=m+n\omega</m>, with <m>m,n\in \Z</m>, we have 
                        <md>
                            <mrow>N(\alpha) \amp = m^2+mn+\frac{1-D}{4}n^2\in \Z  </mrow>
                        </md>.
                    </p>
                </li>
                <li>
                    <p>
                        For all square-free integers <m>D</m>, the restriction of the norm function <m>N</m> to <m>\mathcal{O}</m> defines a multiplicative function <m>N\colon \mathcal{O}\rightarrow \Z</m>. 
                    </p>
                </li>
                <li>
                    <p>
                        <m>\mathcal{O}^*=\{\alpha\in \mathcal{O}\mid N(\alpha)=\pm 1\}</m>. In other words, the units of <m>\mathcal{O}</m> are precisely those elements whose norm is a unit of <m>\Z</m>. 
                    </p>
                </li>
                <li>
                    <p>
                        If <m>\pi\in \mathcal{O}</m> satisfies <m>\abs{N(\pi)}=p</m>, where <m>p</m> is a prime integer, then <m>\pi</m> is irreducible in <m>\mathcal{O}</m>. 
                    </p>
                </li>
            </ol>
        </p>
    </statement>
    <proof>
        <p>
            We leave most of this proof to the reader, restricting ourselves to a few comments. Statement (1) follows immediately from the fact that <m>\alpha\mapsto \overline{\alpha}</m> is a ring homomorphism. 
        </p>
        <p>
            Statement (2) follows from a computation. Note that since <m>D\equiv 1\pmod 4</m> here, the quotient <m>(1-D)/4</m> is in fact an integer! 
        </p>
        <p>
            We give a full proof of (3). If <m>\alpha\in \mathcal{O}^*</m>, then we have <m>1=\alpha\beta</m> for some <m>\beta\in \mathcal{O}</m>, in which case <m>1=N(1)=N(\alpha)N(\beta)</m>. It follows that <m>N(\alpha)\in \Z^*=\{\pm 1\}</m>. Conversely if <m>N(\alpha)=\alpha\overline{\alpha}=\pm 1</m>, then <m>\alpha^{-1}=\pm \overline{\alpha}</m>, showing that <m>\alpha\in \mathcal{O}^*</m>. 
        </p>
        <p>
            We give a full proof of (4). Assume <m>\abs{N(\pi)}=p</m>, a prime integer. Since <m>N(\pi)\ne 0</m>, <m>\pi \ne 0</m>; since <m>N(\pi)\notin \{\pm 1\}</m>, <m>\pi</m> is not a unit.  Given a factorization 
            <m>\pi=\alpha\beta</m> in <m>\mathcal{O}</m>, we have <m>p=\abs{N(\pi)}=\abs{N(\alpha)}\abs{N(\beta)}</m>. Since <m>N(\alpha)</m> and <m>N(\beta)</m> are integers and <m>p</m> is prime, it follows that <m>\{\abs{N(\alpha)},\abs{N(\beta)}\}\subseteq \{1,p\}</m>. Since we cannot have <m>\{\abs{N(\alpha)},\abs{N(\beta)}\}\subseteq \{p\}</m>, one of <m>\alpha</m> and <m>\beta</m> must have a unit norm, making it itself a unit. We conclude that <m>\pi</m> has no nontrivial factorization, and thus that it is irreducible. 
        </p>
    </proof>
</proposition>
<p>
    We have seen that not all quadratic rings of integers are UFDs. Indeed, <m>\Z[\sqrt{-5}]</m> is an example. (And see <xref ref="rem_quad_ring_integers"/> for a more complete picture of the state of affairs here.) However, as a nice illustration of the utility of the norm function, it is easy to see that irreducible factorizations do always exist in these rings, as the next result shows. The issue is that this irreducible factorization may not be unique: <eg/>, <m>6=2\cdot 3=(1+\sqrt{-5})(1-\sqrt{-5})</m>.
    </p>
<corollary xml:id="cor_quad_ring_factorization">
    <title>Existence of factorizations in quadratic rings of integers</title>
    <statement>
        <p>
            Let <m>D</m> be a square-free integer, and let <m>\mathcal{O}=\mathcal{O}_{\sqrt{D}}</m>. Any nonzero, non-unit element of <m>\mathcal{O}</m> can be factored as a product of irreducible elements of <m>\mathcal{O}</m>. 
        </p>
    </statement>
    <proof>
        <p>
            The proof is done by strong induction on <m>\abs{N(\alpha)}</m> for <m>\alpha\in \mathcal{O}</m>. First observe that if <m>\abs{N(\alpha)}=p</m>, then <m>\alpha</m> is irreducible by <xref ref="prop_quad_ring_integers"/>, and we are done. This gives us infinitely many bases cases as it were: <ie/>, we know the result for all <m>\alpha</m> satisfying <m>\abs{N(\alpha)}\in \{2,3,5,7,11,\dots\}</m>. 

        </p>
        <p>
            Now assume that the result holds for all <m>\alpha\in \mathcal{O}</m> with <m>\abs{N(\alpha)}\&lt; n\geq 3</m>. Suppose <m>\alpha\in \mathcal{O}</m> satisfies <m>\abs{N(\alpha)}=n</m>. (This means, in particular, that <m>\alpha</m> is nonzero, and a non-unit.) If <m>\alpha</m> is irreducible, we are done. Otherwise, we have a nontrivial factorization <m>\alpha=\beta\gamma</m>. Since <m>n=\abs{N(\alpha)}=\abs{N(\beta})\abs{N(\gamma)}</m> and since <m>\beta</m> and <m>\gamma</m> are not units, it follows that <m>\abs{N(\beta)}&lt; n</m> and <m>\abs{N(\gamma)}&lt; n</m>. By the induction hypothesis, both <m>\beta</m> and <m>\gamma</m> can be factored as a product of irreducible elements, and thus so can <m>\alpha</m>.
        </p>
    </proof>
</corollary>
</subsection>
<subsection xml:id="ss_gauss_integers">
<title>Ideal structure of <m>\Z[i]</m></title>
<p>
    We now specialize to <m>\Z[i]</m>. Let's gather some facts we already know about this ring. 
    <ul>
        <li>
            <p>
                <m>\Z[i]</m> is a PID, and hence also a UFD. Thus all ideals in <m>\Z[i]</m> are of the form <m>I=(\alpha)</m>. Furthermore, since prime is equivalent to irreducible in UFDs, and since prime is equivalent to maximal in PIDs, the following statements are equivalent. 
                <ul>
                    <li>
                        <p>
                            <m>(\pi)</m> is prime.
                        </p>
                    </li>
                    <li>
                        <p>
                            <m>(\pi)</m> is maximal.
                        </p>
                    </li>
                    <li>
                        <p>
                            <m>\pi</m> is prime.
                        </p>
                    </li>
                    <li>
                        <p>
                            <m>\pi</m> is irreducible. 
                        </p>
                    </li>
                </ul>
            </p>
        </li>
        <li>
            <p>
                An element <m>\alpha=m+ni\in \Z[i]</m> is a unit if and only if <m>N(\alpha)=m^2+n^2\in \{\pm 1\}</m>, if and only if <m>\alpha\in \{\pm 1, \pm i\}</m>. 
            </p>
        </li>
        <li>
            <p>
                Let <m>\pi=m+ni</m>, so that <m>N(\pi)=m^2+n^2</m>.  We know that if <m>\abs{N(\pi)}=N(\pi)=p</m> is a prime integer, then <m>\pi</m> is irreducible. Thus for example, since <m>N(1\pm i)=1^2+1^2=2</m>, the elements <m>1+i</m> and <m>1-i</m> are irreducible, and the factorization <m>2=(1+i)(1-i)</m> is thus an irreducible factorization of <m>2</m> in <m>\Z[i]</m>. In particular, <m>2</m> is no longer prime in <m>\Z[i]</m>. 
            </p>
        </li>
    </ul>
These observations already cover some ground, but leave open some questions. 
<ul>
    <li>
        <p>
            We see that if <m>p=m^2+n^2</m>, then the elements <m>m+ni</m> and <m>m-ni</m> are irreducible, and the factorization <m>p=(m+ni)(m-ni)</m> is an irreducible factorization of <m>p</m> in <m>\Z[i]</m>. In particular, if <m>p=m^2+n^2</m>, then <m>p</m> is not prime in <m>\Z[i]</m>. Is this in fact an equivalence? If so, is there a better way of describing such primes <m>p</m>? 
        </p>
    </li>
    <li>
        <p>
            Are there irreducible elements <m>\pi</m> of <m>\Z[i]</m> that do not satisfy <m>N(\pi)=p</m> for some prime integer <m>p</m>? If so, what is the complete description of the set of irreducible elements of <m>\Z[i]</m>? 
        </p>
    </li>
</ul>
The next result answers the first bullet point's questions. 
</p>
<theorem xml:id="th_prime_factorization">
<title>Factorization of integer primes in <m>\Z[i]</m></title>
<statement>
<p>
Let <m>p</m> be a prime integer. The following statements are equivalent. 
<ol>
    <li>
        <p>
            <m>p</m> is not prime (equivalently, irreducible) in <m>\Z[i]</m>. 
        </p>
    </li>
    <li>
        <p>
            <m>p=m^2+n^2</m> for integers <m>m,n\in \Z</m>. 
        </p>
    </li>
    <li>
        <p>
            <m>p=N(\pi)</m> for some irreducible element <m>\pi\in \Z[i]</m>.
        </p>
    </li>
    <li>
        <p>
            <m>p=\pi \overline{\pi}</m> for some irreducible element <m>\pi \in \Z[i]</m>.
        </p>
    </li>
    <li>
        <p>
            <m>f(x)=x^2+\overline{1}</m> is a reducible polynomial in <m>\F_p[x]</m>. 
        </p>
    </li>
    <li>
        <p>
            <m>[-1]_p</m> is a square in <m>\F_p</m> (<ie/>, <m>-1</m> is a square modulo <m>p</m>). 
        </p>
    </li>
    <li>
        <p>
            <m>p=2</m> or <m>p\equiv 1\pmod 4</m>. 
        </p>
    </li>
</ol>
</p>
</statement>
<proof>
<p>
    Since <m>N(m+ni)=(m+ni)(m-ni)=m^2+n^2</m>, and since <m>N(\pi)=p</m> implies <m>\pi</m> is irreducible, (2), (3) and (4) are clearly equivalent. Furthermore, we know <m>(3)</m> implies (1) by <xref ref="prop_quad_ring_integers"/>. 
</p>
<p>
    Let's prove that (1) implies (3). Assume <m>p</m> is not prime/irreducible in <m>\Z[i]</m>. It follows that we have <m>p=\alpha\beta</m> for some non-units <m>\alpha,\beta\in \Z[i]</m>. From <m>p^2=N(p)=N(\alpha)N(\beta)</m>, it follows that <m>N(\alpha)=N(\beta)=p</m>: otherwise, one of <m>\alpha</m> or <m>\beta</m> would have norm equal to 1, making it a unit. Thus <m>\alpha</m> and <m>\beta</m> are both irreducible (since their norm is prime), and we are done. 
</p>
</proof>
</theorem>
<p>
    It turns out that <xref ref="th_prime_factorization"/> is all that we need to give a complete description of the irreducible elements of <m>\Z[i]</m>. The key connection is that if <m>\pi</m> is irreducible, then the ideal <m>(\pi)</m> contains a unique prime integer <m>p</m>: or equivalently, there is a unique prime integer <m>p</m> such that <m>\pi\mid p</m>. To see why, consider the inclusion homomorphism <m>\phi\colon \Z\rightarrow \Z[i]</m>. Since <m>(\pi)</m> is prime ideal, its inverse image 
    <md>
        <mrow>\phi^{-1}(\pi)=(\pi)\cap \Z </mrow>
    </md>
    is a prime ideal of <m>\Z</m>. Since the integer <m>N(\pi)=\pi\overline{\pi}</m> is an element of <m>(\pi)</m>, <m>(\pi)\cap \Z</m> is a nonzero prime ideal, hence equal to <m>p\Z</m> for some prime integer <m>p\in \Z</m>. Furthermore, we have <m>\pi\mid p</m> if and only if <m>p\in (\pi)</m> if and only if <m>(\pi)\cap \Z=p\Z</m>, showing uniqueness.  It follows that <m>p\in (\pi)</m>. We say that <m>(\pi)</m> <term>lies over</term> the prime <m>p</m> in this case. The corollary below describes the distinct irreducible elements of <m>\Z[i]</m>, up to associates, in terms of the unique primes they lie over. 
</p>
<definition xml:id="d_lying_over">
<title>Lying over</title>
<statement>
<p>
Let <m>\mathcal{O}=\mathcal{O}_{\sqrt{D}}</m> be a quadratic ring of integers. We say an irreducible element <m>\pi\in \mathcal{O}</m> <term>lies over</term> the prime integer <m>p</m> if <m>\pi\mid p</m>. More generally, we say that a prime ideal <m>P</m> of <m>\mathcal{O}</m> lies over the prime integer <m>p</m> if <m>P\cap \Z=p\Z</m>. 
</p>
</statement>
</definition>

<corollary xml:id="cor_gauss_int_irr">
    <title>Irreducible elements of <m>\Z[i]</m></title>
    <statement>
        <p>
            Every irreducible element of <m>\Z[i]</m> lies over a unique prime integer <m>p</m>. 
            Up to associates, the distinct irreducible elements <m>\pi</m> of <m>\Z[i]</m> are described below based on the prime <m>p</m> they lie over. 
            <ul>
                <li>
                    <title>Case: <m>p=2</m></title>
                    <p>
                        Up to associates, <m>\pi=(1+i)</m> is the unique irreducible element of <m>\Z[i]</m> lying over <m>2</m>. 
                    </p>
                </li>
                <li>
                    <title>Case: <m>p\equiv 1\pmod 4</m></title>
                    <p>
                        If <m>p\equiv 1\pmod 4</m>, then there are exactly two irreducible elements lying over <m>p</m> up to associates: namely, <m>\pi=m+ni</m> and <m>\overline{\pi}=m-ni</m>, where <m>(m,n)</m> is any pair of integers satisfying <m>p=m^2+n^2</m>.
                    </p>
                </li>
                <li>
                    <title>Case: <m>p\equiv 3\pmod 4</m></title>
                    <p>
                        If <m>p\equiv 3\pmod 4</m>, then <m>p</m> is irreducible in <m>\Z[i]</m>, and <m>\pi=p</m> is the unique irreducible element of <m>\Z[i]</m> lying over <m>p</m>, up to associates.
                    </p>
                </li>
                
            </ul>
        </p>
    </statement>
    <proof>
        <p>
            Let <m>\pi=1+i</m>.  We have <m>2=\pi\overline{\pi}</m>. Since <m>N(\overline{\pi})=N(\overline{\pi})=2</m>, which is prime, both <m>\pi</m> and <m>\overline{\pi}</m> are irreducible. Furthermore, since <m>1-i=-i(1+i)</m>, we see that <m>\pi</m> and <m>\overline{\pi}</m> are associates. If <m>\pi'</m> is an irreducible element lying over <m>2</m>, so that <m>\pi'\mid 2=\pi\overline{\pi}=(-i)\pi^2</m>, then we must have <m>\pi'\mid \pi</m>. Since <m>\pi</m> is irreducible, it follows that <m>\pi'</m> and <m>\pi</m> are associates. Thus <m>\pi</m> is, up to associates, the unique irreducible element lying over <m>2</m>.  
        </p>
        <p>
            Let <m>p\equiv 1\pmod 4</m>. By <xref ref="th_prime_factorization"/>, there are integers <m>m</m> and <m>n</m> satisfying <m>m^2+n^2=p</m>.  The same argument as above shows that <m>\pi=m+ni</m> and <m>\overline{\pi}=m-ni</m> are the only irreducible elements lying over <m>p</m>, up to associates. Since <m>N(\pi)=m^2+n^2=p</m>, and <m>p\equiv 1\pmod 4</m>, it follows easily that we cannot have <m>m=\pm n</m>, and hence that <m>m-in\ne u(m+ni)</m> for any unit <m>u\in \{\pm 1, \pm i\}</m>. In other words, <m>\pi</m> and <m>\overline{\pi}</m> are not associates. 
        </p>
        <p>
            Let <m>p\equiv 3\pmod 4</m>. By <xref ref="th_prime_factorization"/>, <m>p</m> is itself irreducible in <m>\Z[i]</m>, and thus any irreducible element <m>\pi</m> lying over <m>p</m> must be an associate to <m>p</m>.  Thus <m>p\in (p)</m>, and so <m>(p)</m> lies over <m>p</m>. If <m>\pi</m> is an irreducible element lying over <m>p</m>, then we have <m>\pi\mid p</m>. Since <m>p</m> is irreducible, it follows that <m>\pi</m> and <m>p</m> are associates. Thus, up to associates, the unique irreducible element lying over <m>p</m> is <m>\pi=p</m>.
        </p>
    </proof>
</corollary>
<p><xref ref="fig_specZ_specZi"/> visualizes the <q>lying over</q> relation between primes of <m>\Z[i]</m> and primes of <m>\Z</m>. Each prime ideal of <m>\Z</m> is represented by a point labeled with the ideal's nonnegative generator. The prime ideals <m>(0)</m> in both rings are distinguished in the diagram as they are the unique prime ideals that are not maximal in both rings. (Getting way ahead of ourselves, with respect to the <em>Zariski topology</em>, the set <m>\{(0\}</m> is dense in the space of all prime ideals of <m>Z</m> (or <m>\Z[i]</m>). This is why we've made the points fuzzy.) Observe how the prime ideal <m>(p)</m> for each prime integer in <m>\Z</m> has either one or two prime ideals of <m>\Z[i]</m> lying above it, depending on whether <m>p\equiv 3\pmod 4</m> or not. The prime <m>2</m> is somewhat special in that it does not remain prime in <m>\Z[i]</m>, but it only has one prime ideal lying above it: <m>(1+i)</m>. Since <m>2=(1+i)(1-i)</m>, and <m>(1+i)=(1-i)</m> as ideals, the ideal <m>(2)\subseteq \Z[i]</m> factors as <m>(2)=(1+i)^2</m>. This phenomenon is called <term>ramification</term> (more precisely, we say that <m>2</m> <term>ramifies</term> in <m>\Z[i]</m>) and is indicated in the diagram by the funny dot above <m>2</m>.
</p>
<figure xml:id="fig_specZ_specZi">
    <caption>Primes of <m>\Z[i]</m> lying over primes of <m>\Z</m></caption>
<image>
    <shortdescription>Diagram of relationship between primes of integers and primes of Gaussian integers</shortdescription>
    
<latex-image>
\begin{tikzpicture}[x=1cm,y=1cm]
  %------------------------------------------------------------
  % Parameters
  %------------------------------------------------------------
  \definecolor{NUblue}{RGB}{0,80,180} % pleasant blue
  \def\yUpper{1.6}      % y of the upper line
  \def\yLower{0}        % y of the lower line
  \def\RLeft{-0.8}      % left end of the segments (x)
  \def\RRight{10.4}     % right end of the segments (x) — extended for 13
  \def\rDot{0.12}       % radius of filled dots (larger and blue)
  \def\rRing{0.18}      % radius of ring for ramification at p=2
  \def\vertSplit{0.18}  % vertical offset for split points (above/below)
  % helper macro to draw a "fuzzy" dot at (X,Y) in color C
  % draws a crisp core plus diffuse halos
  \newcommand{\fuzzydot}[3]{%
    \fill[#3, opacity=0.15] (#1,#2) circle (0.32);%
    \fill[#3, opacity=0.25] (#1,#2) circle (0.24);%
    \fill[#3]               (#1,#2) circle (\rDot);%
  }

  % x-positions (in cm) for 0, 2, 3, 5, 7, 11, 13
  \def\xZero{0.0}
  \def\xTwo{1.6}
  \def\xThree{3.2}
  \def\xFive{4.8}
  \def\xSeven{6.4}
  \def\xEleven{8.0}
  \def\xThirteen{9.6}

  %------------------------------------------------------------
  % Lines
  %------------------------------------------------------------
  \draw[very thick] (\RLeft,\yLower) -- (\RRight,\yLower);
  \draw[very thick] (\RLeft,\yUpper) -- (\RRight,\yUpper);

  % Labels for lines
  \node[anchor=east] at (\RLeft,\yLower) {$\mathbb{Z}$};
  \node[anchor=east] at (\RLeft,\yUpper) {$\mathbb{Z}[i]$};

  %------------------------------------------------------------
  % Lower line: points and labels
  %   • 0 is shown "fuzzy" (prime but not maximal)
  %   • primes 2,3,5,7,11,13 are crisp blue points
  %------------------------------------------------------------
  % 0 (fuzzy)
  \fuzzydot{\xZero}{\yLower}{NUblue}
  \node[below=3pt] at (\xZero,\yLower) {$0$};

  % primes on lower line
  \foreach \x/\lab in {\xTwo/$2$, \xThree/$3$, \xFive/$5$, \xSeven/$7$, \xEleven/$11$, \xThirteen/$13$} {
    \fill[NUblue] (\x,\yLower) circle (\rDot);
    \node[below=3pt] at (\x,\yLower) {\(\lab\)};
  }

  %------------------------------------------------------------
  % Upper line: fibers over each lower point
  %   • 0 (fuzzy) to indicate (0) is prime but not maximal
  %   • 2 is ramified (circled dot)
  %   • 3,7,11 inert (single dot on the line)
  %   • 5,13 split (two dots, one just above and one just below the line)
  %------------------------------------------------------------

  % 0 (fuzzy) on upper line
  \fuzzydot{\xZero}{\yUpper}{NUblue}

  % p = 2 (ramified): circled blue dot
  \fill[NUblue] (\xTwo,\yUpper) circle (\rDot);
  \draw[NUblue, line width=0.7pt] (\xTwo,\yUpper) circle (\rRing);

  % inert primes (3,7,11): single blue dot exactly on the upper line
  \foreach \x in {\xThree,\xSeven,\xEleven} {
    \fill[NUblue] (\x,\yUpper) circle (\rDot);
  }

  % split primes (5 and 13): two blue dots, one slightly above, one slightly below
  \foreach \x in {\xFive,\xThirteen} {
    \fill[NUblue] (\x,\yUpper+\vertSplit) circle (\rDot);
    \fill[NUblue] (\x,\yUpper-\vertSplit) circle (\rDot);
  }

  % (Optional annotations — leave commented for a clean figure)
  % \node[above=2pt] at (\xTwo,\yUpper) {\scriptsize ramified};
  % \node[above=2pt] at (\xFive,\yUpper+\vertSplit) {\scriptsize splits};
  % \node[above=2pt] at (\xThirteen,\yUpper+\vertSplit) {\scriptsize splits};
  % \node[above=2pt] at (\xThree,\yUpper) {\scriptsize inert};
  % \node[above=2pt] at (\xSeven,\yUpper) {\scriptsize inert};
  % \node[above=2pt] at (\xEleven,\yUpper) {\scriptsize inert};

\end{tikzpicture}
</latex-image>

</image>
</figure>    
<corollary xml:id="cor_integer_sum_squares">
    <title>Sums of two squares</title>
    <statement>
        <p>
            Let <m>n</m> be a positive integer with factorization 
            <md>
                <mrow>n \amp = 2^k\cdot \prod_{i=1}^{r}p_i^{n_i}\cdot \prod_{j=1}^s q_j^{m_j}</mrow>
            </md>,
            where the <m>p_i</m> and <m>q_j</m> are distinct odd primes, <m>p_i\equiv 1 \pmod 4</m> for all <m>i</m>, and <m>q_j\equiv 3\pmod 4</m> for all <m>j</m>. We have <m>n=a^2+b^2</m> for integers <m>a</m> and <m>b</m> if and only if <m>m_j</m> is even for all <m>j</m>. Furthermore, when this is the case there are exactly 
            <md>
                <mrow>4(n_1+1)(n_2+1)\cdots (n_r+1) \amp </mrow>
            </md>
            pairs <m>(a,b)\in \Z^2</m> satisfying <m>n=a^2+b^2</m>. 
        </p>
    </statement>
    <proof>
        <p>
            We have <m>n=a^2+b^2</m> if and only if <m>n=N(\alpha)</m>, where <m>\alpha=a+bi</m>. Since, for an irreducible element <m>\pi\in \Z[i]</m> we have <m>N(\pi)\in \{p, p^2\}</m>, where <m>p</m> is the unique prime lying below <m>\pi</m>, it follows that any irreducible element <m>\pi</m> appearing in the factorization of <m>n</m> lies over <m>2</m>, <m>p_i</m> for some <m>1\leq i\leq r</m>, or <m>q_j</m> for some <m>1\leq j\leq s</m>. With the help of  <xref ref="cor_gauss_int_irr"/>, we can pick irreducible elements <m>\pi_i</m> lying over <m>p_i</m> for each <m>i</m>, so that up to associates <m>\pi_i</m> and <m>\overline{\pi_i}</m> are the distinct irreducible elements lying over <m>p_i</m>. The corollary also tells us that up to associates <m>1+i</m> and <m>q_j</m> are the unique irreducible elements lying over <m>2</m> and <m>q_j</m>, respectively. It follows that if <m>N(\alpha)=n</m>, then we can write <m>\alpha</m> <em>uniquely</em> in the form 
            <md>
                <mrow>\alpha \amp =u (1+i)^{k'}\prod_{i=1}^r \pi_i^{a_i}\overline{\pi}_i^{b_i} \prod_{j=1}^s q_j^{m_j'}</mrow>
            </md>,
            where <m>u\in \{1,-1,i,-i\}</m> is a unit. 
            But then we have 
            <md>
                <mrow>N(\alpha)=n \amp \iff 
                    N(u)N(1+i)^{k'}\prod_{i=1}^r N(\pi_i)^{a_i}N(\overline{\pi}_i)^{b_i} \prod_{j=1}^s N(q_j)^{m_j'} =2^{k}\prod_{i=1}^r p_i^{n_i} \prod_{j=1}^s q_j^{m_j}</mrow>
                    <mrow>\amp\iff  2^{k'}\prod_{i=1}^rp_i^{a_i+b_i}\cdot \prod_{j=1}^s q^{2m_j'} = 2^{k}\prod_{i=1}^r p_i^{n_i} \prod_{j=1}^s q_j^{m_j} </mrow>
                    <mrow> \amp \iff k'=k, a_i+b_i=n_i, 2m_j'=m_j</mrow>
            </md>
            for all <m>1\leq i\leq r</m>, <m>1\leq j\leq s</m>. Equivalently, we must have <m>m_j</m> even for all <m>j</m>, and <m>m_j'/2</m>, and <m>(a_i,b_i)=(a_i, n_i-b_i)</m> for <m>a_i\in \{0,1,\dots, n_i\}</m>. We conclude that <m>n=a^2+b^2</m> if and only if <m>n=N(\alpha)</m> for an element <m>\alpha\in \Z[i]</m> that can we written uniquely as 
            <md>
                <mrow>\alpha \amp = u (1+i)^k \cdot \prod_{i=1}^r \pi_i^{a_i}\overline{\pi}_i^{n_i-a_i}\cdot \prod_{j=1}^s q_j^{m_j/2}</mrow>
            </md>,
            where <m>u\in \{1,-1,i,-i\}</m> is any unit, and <m>a_i\in \{0,1,\dots, n_i\}</m>. Since we have <m>4</m> choices for <m>u</m> and <m>n_i+1</m> choices for each <m>a_i</m>, the result follows. 
        </p>
    </proof>
</corollary>

</subsection>
</section>